# Integration Data Flow Guide: Input & Output Specifications

This guide details the exact data format entering and leaving the system at each stage of the diagnostic process. Use this to design your frontend state management and UI displays.

## Phase 1: Symptom Extraction

**Goal**: Convert raw user natural language into standardized machine-readable symptoms.

### Input (From Frontend)
**User Text**: The raw description typed by the user.
```json
{
  "user_input": "I have a weird rash on my arm and I've been feeling really dizzy lately."
}
```

### Output (To Frontend)
**Standardized Symptoms**: A list of strict symptom keys that match the internal database.
```json
{
  "extracted_symptoms": [
    "skin_rash",
    "dizziness"
  ]
}
```
*UI Suggestion*: Display these as removable "tags". Allow the user to confirm they are correct before proceeding.

---

## Phase 2: Prediction & filtering

**Goal**: Get an initial assessment and determine if more information (filtering questions) is needed.

### Input (From Frontend)
**Confirmed Symptoms**: The list of symptoms approved by the user.
```json
{
  "symptoms": [
    "skin_rash",
    "dizziness"
  ]
}
```

### Output (To Frontend)
**Assessment Result**: Returns potential diseases and a confidence flag.
```json
{
  "top_diseases": [
    { "name": "Fungal infection", "prob": 40 },
    { "name": "Allergy", "prob": 30 },
    { "name": "Drug Reaction", "prob": 20 }
  ],
  "confidence_score": 65.0,
  "needs_followup": true,
  "followup_questions": [
    "Do you have a fever?",
    "Is the rash itchy?",
    "Have you taken any new medications recently?"
  ]
}
```
* **If `needs_followup` is `false`**: Skip to Phase 3 immediately.
* **If `needs_followup` is `true`**: Render the `followup_questions` to the user.

---

## Phase 3: Final Diagnosis

**Goal**: Provide the final medical recommendation based on all gathered context.

### Input (From Frontend)
**Complete Context**: All data points collected so far (Original symptoms, initial ML guesses, and answers to follow-up questions).
```json
{
  "symptoms": ["skin_rash", "dizziness"],
  "initial_prediction": [
    { "name": "Fungal infection" },
    { "name": "Allergy" },
    { "name": "Drug Reaction" }
  ],
  "qa_pairs": [
    {
      "question": "Do you have a fever?",
      "answer": "No"
    },
    {
      "question": "Is the rash itchy?",
      "answer": "Yes, very itchy"
    },
    {
      "question": "Have you taken any new medications recently?",
      "answer": "No"
    }
  ]
}
```

### Output (To Frontend)
**Final Report**: The comprehensive diagnosis generated by the LLM.
```json
{
  "diagnosis_result": {
    "disease": "Fungal Infection",
    "specialist": "Dermatologist",
    "reasoning": "The combination of a skin rash without fever, accompanied by itching, strongly suggests a fungal infection rather than a systemic viral issue or drug reaction.",
    "advice": "Consult a dermatologist for a skin scraping test. Keep the area dry and avoid sharing towels."
  }
}
```
*UI Suggestion*: Display this as a formal medical card or report.
